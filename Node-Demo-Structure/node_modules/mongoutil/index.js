'use strict'
const MongoClient = require('mongodb')
const assert = require('assert');

const getMongoConnectionString = () => {
    let connection = 'mongodb://';
    connection+= process.env.MONGODB_USERNAME ? `${process.env.MONGODB_USERNAME}:${process.env.MONGODB_PASSWORD}@`:'';
    connection+= process.env.MONGODB_HOST;
    connection+= process.env.MONGODB_PORT ? process.env.MONGODB_PORT : "";
    connection+= process.env.MONGODB_DB ? '/'+process.env.MONGODB_DB : "";
    return connection

}


module.exports = function(){
    let _db
    console.log('testing the new package')

    return {


        connectToServer: function () {
            MongoClient.connect(getMongoConnectionString(), function (err, db) {
                _db = db;
                assert.equal(null,err);
            });
        },

        getDb: function () {
            return _db;
        }
    }
};